par(mfrow = c(1, 2))
plot(ca, invisible = "col")
knitr::opts_chunk$set(echo = FALSE, fig.align = "center")
library(formattable)
library(tibble)
library(tidyr)
library(dplyr)
affTable <- function (tab, nrow = 8, ncol = 8, digits = 2) {
formattable(
round(tab, digits),
list(
area(1:nrow, 1:ncol) ~ color_tile("lightsalmon","lightblue")
)
)
}
formattable(as.data.frame(apply(Titanic, c(1,4), sum)),
table.attr = "class=\"table table-condensed centering\"")
o = occupationalStatus %>%
data.frame() %>%
mutate(origin = paste0("orig=", origin),
destination = paste0("dest=", destination)) %>%
spread(destination, Freq) %>%
remove_rownames() %>%
column_to_rownames("origin")
affTable(as.data.frame(addmargins(as.matrix(o))))
p = 100 * prop.table(o)
affTable(as.data.frame(addmargins(as.matrix(p))))
pl = as.data.frame(100 * prop.table(as.matrix(o), margin = 1))
affTable(as.data.frame(addmargins(as.matrix(pl), 2)))
pc = as.data.frame(100 * prop.table(as.matrix(o), margin = 2))
affTable(as.data.frame(addmargins(as.matrix(pc), 1)))
library(FactoMineR)
ca = CA(o, graph = FALSE)
formattable(round(setNames(data.frame(ca$eig), c("Valeur propre", "Variance (%)", "Cumul√©e (%)")), 2), row.names = TRUE)
par(mar = c(2, 2, 1, 1) + .5)
barplot(ca$eig[,2])
par(mfrow = c(1, 2))
plot(ca, invisible = "col")
plot(ca, invisible = "row")
